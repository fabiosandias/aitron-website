services:
  aitron-web:
    image: aitron-website:latest
    environment:
      - TZ=America/Sao_Paulo
    networks:
      - infra-n8n-chatmega
    deploy:
      mode: replicated
      replicas: 1
      labels:
        - "traefik.enable=true"
        # Router principal (aitron.com.br)
        - "traefik.http.routers.aitron.rule=Host(`aitron.com.br`)"
        - "traefik.http.routers.aitron.entrypoints=websecure"
        - "traefik.http.routers.aitron.service=aitron"
        - "traefik.http.routers.aitron.tls.certresolver=letsencryptresolver"
        # Router www (adicionar depois de corrigir DNS no Cloudflare)
        - "traefik.http.routers.aitron-www.rule=Host(`www.aitron.com.br`)"
        - "traefik.http.routers.aitron-www.entrypoints=websecure"
        - "traefik.http.routers.aitron-www.service=aitron"
        - "traefik.http.routers.aitron-www.tls.certresolver=letsencryptresolver"
        # Service
        - "traefik.http.services.aitron.loadbalancer.server.port=80"
        - "traefik.http.services.aitron.loadbalancer.passHostHeader=true"

networks:
  infra-n8n-chatmega:
    external: true
